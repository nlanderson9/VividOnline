<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <script src="jspsych/jspsych.js"></script>
    <script src="jspsych/plugin-html-keyboard-response.js"></script>
    <script src="jquery-3.7.1.min.js"></script>
    <script src="jquery.csv.js"></script>
    <link href="jspsych/jspsych.css" rel="stylesheet" type="text/css" />
  </head>
  <body></body>
  <script>

    var data = "";

    test = $.ajax({
            type: "GET",
            url: "stimuli.csv",
            dataType: "text",
            async: false,
            success: function(r) {
              data = r
            },
            error: function(r) {
              console.log(r)
            }
          });

    console.log(data);
    var csv_data = $.csv.toObjects(data);
    console.log(csv_data);

    var test_stimuli = csv_data.slice(0,4);





    var jsPsych = initJsPsych();
    timeline = [];


    /* define welcome message trial */
    var welcome = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: "Welcome to the experiment. Press any key to begin."
    };
    timeline.push(welcome);

    /* define imagine and question trials */
    var imagine = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: jsPsych.timelineVariable('stimulus'),
      data: {
        task: 'imagine',
        condition: jsPsych.timelineVariable('condition')
      }
    };

    var question = {
      type: jsPsychHtmlSliderResponse,
      stimulus: jsPsych.timelineVariable('stimulus'),
      require_movement: true,
      labels: ['Strongly Disagree', '', 'Disagree', '', 'Neutral', '', 'Agree', '', 'Strongly Agree'],
      data: {
        task: 'questions',
        condition: jsPsych.timelineVariable('condition')
      }
    };

    /* define test procedure */
    var test_procedure = {
      timeline: [imagine, question],
      timeline_variables: test_stimuli
    };
    timeline.push(test_procedure);


    jsPsych.run(timeline);
  </script>
</html>